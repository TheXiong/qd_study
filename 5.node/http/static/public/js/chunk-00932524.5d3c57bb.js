(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-00932524"],{"001e":function(e,t,r){},"1ae2":function(e,t,r){"use strict";var a=r("8480");r.n(a).a},"6b16":function(e,t,r){"use strict";var a=r("001e");r.n(a).a},8480:function(e,t,r){},"9b70":function(e,t,r){"use strict";r.r(t);var a=r("fec3"),s={name:"modifyPass",data:function(){var e=this;return{passForm:{pre_pass:"",new_pass:"",check_pass:""},rules:{pre_pass:[{required:!0,message:"请输入原密码",trigger:"blur"},{min:6,max:18,message:"原密码长度在 6 到 18 个字符",trigger:"blur"}],new_pass:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:18,message:"新密码长度在 6 到 18 个字符",trigger:"blur"}],check_pass:[{required:!0,validator:function(t,r,a){""===r?a(new Error("请再次输入新密码")):r!==e.passForm.new_pass?a(new Error("两次输入密码不一致!")):a()},trigger:"blur"}]},prePassType:"password",newPassType:"password",checkPassType:"password"}},methods:{resetForm:function(e){this.$refs[e].resetFields()},showPwd:function(e){var t=e+"PassType";"password"===this[t]?this[t]="text":this[t]="password"},handleSubmit:function(e){var t=this;this.$refs[e].validate(function(r){if(!r)return!1;Object(a.a)(t.passForm).then(function(r){t.$refs[e].resetFields(),t.$message({showClose:!0,message:r.data.msg,type:"success"})})})}}},o=(r("1ae2"),r("2877")),n=Object(o.a)(s,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("修改密码")])]),r("el-form",{ref:"ruleForm",attrs:{model:e.passForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"原密码",prop:"pre_pass"}},[r("el-input",{attrs:{type:e.prePassType,placeholder:"请输入6~18个字符的原密码",name:"password","auto-complete":"on"},model:{value:e.passForm.pre_pass,callback:function(t){e.$set(e.passForm,"pre_pass",t)},expression:"passForm.pre_pass"}}),r("span",{staticClass:"show-pwd",on:{click:function(t){return e.showPwd("pre")}}},[r("svg-icon",{attrs:{"icon-class":"password"===e.prePassType?"eye":"eye-open"}})],1)],1),r("el-form-item",{attrs:{label:"新密码",prop:"new_pass"}},[r("el-input",{attrs:{type:e.newPassType,placeholder:"请输入6~18个字符的新密码",name:"password","auto-complete":"on"},model:{value:e.passForm.new_pass,callback:function(t){e.$set(e.passForm,"new_pass",t)},expression:"passForm.new_pass"}}),r("span",{staticClass:"show-pwd",on:{click:function(t){return e.showPwd("new")}}},[r("svg-icon",{attrs:{"icon-class":"password"===e.newPassType?"eye":"eye-open"}})],1)],1),r("el-form-item",{attrs:{label:"确认密码",prop:"check_pass"}},[r("el-input",{attrs:{type:e.checkPassType,placeholder:"请再次输入新密码",name:"password","auto-complete":"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSubmit("ruleForm")}},model:{value:e.passForm.check_pass,callback:function(t){e.$set(e.passForm,"check_pass",t)},expression:"passForm.check_pass"}}),r("span",{staticClass:"show-pwd",on:{click:function(t){return e.showPwd("check")}}},[r("svg-icon",{attrs:{"icon-class":"password"===e.checkPassType?"eye":"eye-open"}})],1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("ruleForm")}}},[e._v("提交")]),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)},[],!1,null,"4d34b8f4",null).exports,l=r("cebc"),i=r("f499"),c=r.n(i),u=r("0a0d"),p=r.n(u),m=(r("3b2b"),r("5f87")),d=r("127f"),f=(r("4360"),{name:"modifyInfo",data:function(){return{ruleForm:{name:"",nick:"",gender:"",birthday:""},rules:{name:[{required:!0,validator:function(e,t,r){var a=new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]");t?a.test(t)?r(new Error("姓名不允许包含特殊字符")):t.length>32?r(new Error("姓名不允许超过32字符")):r():r(new Error("姓名不能为空"))},trigger:["blur","change"]}],nick:[{validator:function(e,t,r){var a=new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]");t?a.test(t)?r(new Error("昵称不允许包含特殊字符")):t.length>32?r(new Error("昵称不允许超过32字符")):r():r()},trigger:["blur","change"]}],gender:[{}],birthday:[{}]},imageUrl:"",token:{"X-Token":Object(m.a)()},genderMap:{"":"未知",1:"男",2:"女"},pickerOptions:{disabledDate:function(e){return e.getTime()>p()()-864e4}}}},mounted:function(){this.getInfo()},methods:{fnUploadRequest:function(e){d.a.ossUploadFile(e)},getInfo:function(){var e=this;Object(a.c)().then(function(t){var r={};for(var a in e.ruleForm)r[a]=e.fomatData(a,t.data.data.data[a]);e.imageUrl=t.data.data.data.uri,e.ruleForm=r,e.ruleFormCopy=JSON.parse(c()(r))})},handleAvatarSuccess:function(e,t){this.imageUrl=e.requestUrls[0],this.$message({showClose:!0,message:"上传成功",type:-1===e.code?"error":"success"})},beforeAvatarUpload:function(e){var t=0===e.type.indexOf("image"),r=e.size/1024/1024<20;return t||this.$message.error("上传头像只能是图片!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&r},handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var r=Object(l.a)({},t.ruleForm);r.birthday=r.birthday/1e3,r.uri=t.imageUrl,Object(a.b)(r).then(function(e){t.getInfo(),t.$store.dispatch("GetUserInfo"),t.$message({showClose:!0,message:e.data.msg,type:"success"})})})},resetForm:function(e){this.$refs[e].clearValidate(),this.ruleForm=JSON.parse(c()(this.ruleFormCopy))},birthdayChange:function(e){this.ruleForm.birthday=e+""},fomatData:function(e,t){switch(e){case"birthday":return 1e3*t+"";default:return t}}}}),h=(r("6b16"),{name:"modify",components:{modifyPass:n,modifyInfo:Object(o.a)(f,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("个人配置")])]),r("el-row",{staticClass:"row-bg avatar-box",attrs:{type:"flex",justify:"space-around"}},[r("el-col",{attrs:{span:4}},[r("el-upload",{staticClass:"avatar-container",attrs:{action:"","http-request":e.fnUploadRequest,headers:e.token,"show-file-list":!1,accept:"image/*","on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?r("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):e._e(),e.imageUrl?r("i",{staticClass:"el-icon-upload avatar-uploader-edit"},[e._v("头像编辑")]):e._e(),e.imageUrl?e._e():r("i",{staticClass:"el-icon-upload avatar-uploader-add"},[e._v("头像上传")])])],1)],1),r("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"姓名",prop:"name"}},[r("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"9","show-word-limit":""},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),r("el-form-item",{attrs:{label:"昵称",prop:"nick"}},[r("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"9","show-word-limit":""},model:{value:e.ruleForm.nick,callback:function(t){e.$set(e.ruleForm,"nick",t)},expression:"ruleForm.nick"}})],1),r("el-form-item",{attrs:{label:"性别",prop:"gender"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.gender,callback:function(t){e.$set(e.ruleForm,"gender",t)},expression:"ruleForm.gender"}},e._l(e.genderMap,function(e,t){return r("el-option",{key:t,attrs:{label:e,value:t}})}),1)],1),r("el-form-item",{attrs:{label:"出生日期",prop:"birthday"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy 年 MM 月 dd 日","value-format":"timestamp","picker-options":e.pickerOptions},on:{change:e.birthdayChange},model:{value:e.ruleForm.birthday,callback:function(t){e.$set(e.ruleForm,"birthday",t)},expression:"ruleForm.birthday"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("ruleForm")}}},[e._v("提交")]),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("取消")])],1)],1)],1)},[],!1,null,"d98e48ba",null).exports},data:function(){return{}},methods:{}}),b=Object(o.a)(h,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"app-container"},[t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[t("el-col",{attrs:{span:8}},[t("modify-info")],1),t("el-col",{attrs:{span:10}},[t("modify-pass")],1)],1)],1)},[],!1,null,null,null);t.default=b.exports}}]);