(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2b01cb89"],{6848:function(e,t,a){"use strict";var i=a("a7f2");a.n(i).a},a3b8:function(e,t,a){"use strict";a.r(t);var i=a("5176"),o=a.n(i),l=(a("7f7f"),a("cebc")),r=a("fb04"),s=a("795b"),n=a.n(s),d=(a("ac6a"),a("5df3"),{name:"tableForm",data:function(){return{}},props:["data","dialogFormVisible","formRule","formTitle","editable","addable","deleteable","buttonConf"],methods:{addMore:function(){var e={};for(var t in this.formRule)this.formRule[t].defaultValue?e[t]=this.formRule[t].defaultValue:e[t]="";this.data.list.push(e)},submitApart:function(e,t){var a=this,i=[];for(var o in this.formRule)i.push("list."+t+"."+o);var l=this;n.a.all(i.map(function(e){return new n.a(function(t,a){l.$refs.tableForm.validateField(e,function(e){t(e)})})})).then(function(t){t.filter(function(e){return e}).length||a.$emit("addorUpdateConf",e)})},deleteItem:function(e,t){var a=this;e.vv?this.$confirm("你确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$emit("delConf",e)}).catch(function(){a.$message({type:"info",message:"已取消删除"})}):this.data.list.splice(t,1)},handleClose:function(e){this.resetForm()},closeForm:function(e){this.resetForm()},resetForm:function(){this.$emit("dialog-close"),this.$refs.tableForm.resetFields()},switchChange:function(e){this.$emit("switchChange",e)}}}),u=(a("6848"),a("2877")),c={name:"projectConf",components:{tableForm:Object(u.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.formTitle,visible:e.dialogFormVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"tableForm",attrs:{model:e.data}},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.data.list}},[e._l(e.formRule,function(t,i){return a("el-table-column",{key:i,attrs:{align:"center",label:t.label,width:t.width},scopedSlots:e._u([{key:"default",fn:function(o){return[a("el-form-item",{attrs:{prop:"list."+o.$index+"."+i,rules:t.rule}},["switch"==t.type?a("el-switch",{attrs:{"active-text":t.options.activeText,"inactive-text":t.options.inactiveText,"active-value":t.options.activeValue,"inactive-value":t.options.inactiveValue,disabled:!!t.disabledOption&&t.disabledOption(o.row)},on:{change:function(t){return e.switchChange(o.row)}},model:{value:o.row[i],callback:function(t){e.$set(o.row,i,t)},expression:"scope.row[key]"}}):a("el-input",{staticStyle:{width:"80px"},attrs:{disabled:!!t.disabledOption&&t.disabledOption(o.row),maxlength:"10"},model:{value:o.row[i],callback:function(t){e.$set(o.row,i,t)},expression:"scope.row[key]"}})],1)]}}])})}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",disabled:!!e.buttonConf.saveDisabledOption&&e.buttonConf.saveDisabledOption(t.row)},on:{click:function(a){return e.submitApart(t.row,t.$index)}}},[e._v("保存")]),a("el-button",{attrs:{disabled:!!e.buttonConf.delDisabledOption&&e.buttonConf.delDisabledOption(t.row),size:"small",type:"danger"},on:{click:function(a){return e.deleteItem(t.row,t.$index)}}},[e._v("删除")])]}}])})],2),a("el-form-item",[a("el-button",{attrs:{disabled:!e.addable},on:{click:e.addMore}},[e._v("追加")])],1)],1)],1)},[],!1,null,"b3a26cc2",null).exports},data:function(){return{uri:"program",configList:[],editConfigList:[],editConfigNames:["名称","别名","是否启用"],search:"",dialogFormVisible:!1,addFormVisible:!1,formTitle:"",editable:this.$store.getters.is_root,deleteable:this.$store.getters.is_root,addable:this.$store.getters.is_root,editRow:null,form:{database:"",hash:"",column:"",database_value:"",program_value:"",reality_value:"",order_value:""},rules:{database:[],hash:[{required:!0,message:"表名不能为空",trigger:"blur"}]},formLabelWidth:"120px",tableForm:null,tableFormRule:{order_value:{label:"排序",type:"text",rule:[{required:!0,message:"排序不能为空",trigger:"blur"},{pattern:/^\d+$/,message:"排序只能为数字"}]},column:{label:"列",type:"text",rule:[{required:!0,message:"列值不能为空",trigger:"blur"}]},database_value:{label:"数据库存储值",type:"text",rule:[{required:!0,message:"数据库存储值不能为空",trigger:"blur"},{pattern:/^-?\d+$/,message:"排序只能为数字"}]},program_value:{label:"程序值",type:"text",rule:[{required:!0,message:"程序值不能为空",trigger:"blur"}]},reality_value:{label:"实际值",type:"text",rule:[{required:!0,message:"实际值不能为空",trigger:"blur"}]}},buttonConf:{}}},created:function(){this.formCopy=Object(l.a)({},this.form),this.tableForm=Object(l.a)({},this.form)},mounted:function(){this.getList({})},methods:{getList:function(e){var t=this;Object(r.h)(e,this.uri).then(function(e){t.configList=e.data.data.data})},getEditList:function(e){var t=this;Object(r.h)(e,this.uri).then(function(e){t.editConfigList=e.data.data.data})},handleEdit:function(e,t){this.dialogFormVisible=!0,this.formTitle=t.name,this.editRow=Object(l.a)({},t),this.getEditList({conf_type:t.hash},this.uri)},addorUpdateConf:function(e){var t=this,a=o()({},this.editRow,e);(e.vv?Object(r.q)(a,this.uri):Object(r.a)(a,this.uri)).then(function(e){t.$message({showClose:!0,message:e.data.msg,type:"success"}),t.getEditList({conf_type:t.editRow.hash})})},delOneConf:function(e){var t=this;Object(r.f)({vv:e.vv},this.uri).then(function(e){t.$message({showClose:!0,message:e.data.msg,type:"success"}),t.getEditList({conf_type:t.editRow.hash})})},closeTableForm:function(){this.dialogFormVisible=!1,this.editRow=null},addTable:function(e){var t=this;this.$refs[e].validate(function(e){e&&Object(r.a)(Object(l.a)({},t.form,{column:"0",database_value:0,program_value:"0",reality_value:"0",order_value:0}),t.uri).then(function(e){t.$message({showClose:!0,message:e.data.msg,type:"success"}),t.resetForm(),t.getList({})})})},handleClose:function(e){this.resetForm(),e()},closeForm:function(e){this.resetForm()},resetForm:function(){this.addFormVisible=!1,this.$refs.ruleForm.resetFields(),this.form=Object(l.a)({},this.formCopy)}}},f=Object(u.a)(c,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.addFormVisible=!0}}},[e._v("添加")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.configList.filter(function(t){return!e.search||t.name.toLowerCase().includes(e.search.toLowerCase())||t.hash.toLowerCase().includes(e.search.toLowerCase())})}},[a("el-table-column",{attrs:{align:"center",label:"名称",prop:"hash"}}),a("el-table-column",{attrs:{align:"center",label:"描述",prop:"name"}}),a("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")])]}}])})],1),a("el-dialog",{attrs:{title:"新增",visible:e.addFormVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.addFormVisible=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"数据库名","label-width":e.formLabelWidth,prop:"database"}},[a("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"64","show-word-limit":""},model:{value:e.form.database,callback:function(t){e.$set(e.form,"database",t)},expression:"form.database"}})],1),a("el-form-item",{attrs:{label:"表名","label-width":e.formLabelWidth,prop:"hash"}},[a("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"64","show-word-limit":""},model:{value:e.form.hash,callback:function(t){e.$set(e.form,"hash",t)},expression:"form.hash"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeForm("ruleForm")}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addTable("ruleForm")}}},[e._v("确 定")])],1)],1),a("table-form",{attrs:{formTitle:e.formTitle,dialogFormVisible:e.dialogFormVisible,data:{list:e.editConfigList},formRule:e.tableFormRule,buttonConf:e.buttonConf,editable:e.editable,deleteable:e.deleteable,addable:e.addable},on:{addorUpdateConf:e.addorUpdateConf,delConf:e.delOneConf,"dialog-close":e.closeTableForm}})],1)},[],!1,null,null,null);t.default=f.exports},a7f2:function(e,t,a){}}]);