(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0ab2c5"],{"13c0":function(t,e,a){"use strict";a.r(e);a("7f7f");var l=a("cebc"),o=a("e814"),s=a.n(o),i=a("f499"),n=a.n(i),r=(a("386d"),a("333d")),c=a("fa7d"),u=a("b157"),f={name:"leave",components:{Pagination:r.a},data:function(){return{htmlDecode:c.a.htmlDecode,leaveList:[],listQuery:{page:1,limit:10},search:{job:"",type:"",staff:"",status:"",create_time:""},total:0,leaveDetailTotal:0,listLoading:!1,dialogFormVisible:!1,leaveDetailList:[],leaveTypeList:[],subJobList:[],subUserList:[],subUserOption:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},leaveStatusList:[{name:"拒绝",vv:-1},{name:"待审核",vv:0},{name:"同意",vv:1},{name:"上报",vv:2}]}},mounted:function(){this.getTypeList(),this.getSubJobList(),this.getSubUserList(),this.getList()},methods:{getTypeList:function(){var t=this;Object(u.j)().then(function(e){t.leaveTypeList=e.data.data.data})},getSubJobList:function(){var t=this;Object(u.a)().then(function(e){t.subJobList=e.data.data.data})},getSubUserList:function(){var t=this;Object(u.b)({job:this.search.job}).then(function(e){t.subUserList=e.data.data.data,t.subUserOption=e.data.data.data})},getList:function(){var t=this;this.listLoading=!0;var e=JSON.parse(n()(this.search));e.create_time&&e.create_time.push&&(e.time_start=s()(e.create_time[0]/1e3),e.time_end=s()(e.create_time[1]/1e3)),e.status=""===e.status?-999:e.status,delete e.create_time,Object(u.e)(Object(l.a)({},this.listQuery,e)).then(function(e){t.listLoading=!1,t.leaveList=e.data.data.data.lists,t.total=e.data.data.data.total})},paginationChange:function(){this.getList()},doSearch:function(){this.listQuery={page:1,limit:10},this.getList()},resetSearch:function(){this.search={job:"",type:"",staff:"",status:"",create_time:""},this.getList()},filterUser:function(t){var e=this.subUserList.filter(function(e){return-1!=e.name.indexOf(t)||-1!=e.mobile.indexOf(t)});this.subUserOption=e},jobChange:function(){var t=JSON.parse(n()(this.search));t.staff="",this.search=t,this.getSubUserList()},handleDetail:function(t){var e=this;Object(u.f)({holiday:t}).then(function(t){e.leaveDetailList=t.data.data.data.lists,e.leaveDetailTotal=t.data.data.data.total,e.dialogFormVisible=!0})}}},p=a("2877"),d=Object(p.a)(f,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-form",{ref:"searchForm",attrs:{inline:!0,model:t.search}},[a("el-form-item",{attrs:{label:"部门"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:t.jobChange},model:{value:t.search.job,callback:function(e){t.$set(t.search,"job",e)},expression:"search.job"}},t._l(t.subJobList,function(e){return a("el-option",{key:e.vv,attrs:{label:t.htmlDecode(e.spacer)+e.name,value:e.vv}})}),1)],1),a("el-form-item",{attrs:{label:"请假人"}},[a("el-select",{attrs:{filterable:"",clearable:"","filter-method":t.filterUser,placeholder:"搜索姓名或电话"},model:{value:t.search.staff,callback:function(e){t.$set(t.search,"staff",e)},expression:"search.staff"}},t._l(t.subUserOption,function(t){return a("el-option",{key:t.vv,attrs:{label:t.name,value:t.vv}})}),1)],1),a("el-form-item",{attrs:{label:"请假类型"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},t._l(t.leaveTypeList,function(t){return a("el-option",{key:t.vv,attrs:{label:t.name,value:t.vv}})}),1)],1),a("el-form-item",{attrs:{label:"请假状态"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.search.status,callback:function(e){t.$set(t.search,"status",e)},expression:"search.status"}},t._l(t.leaveStatusList,function(t){return a("el-option",{key:t.vv,attrs:{label:t.name,value:t.vv}})}),1)],1),a("el-form-item",{attrs:{label:"请假时间"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions,"value-format":"timestamp"},model:{value:t.search.create_time,callback:function(e){t.$set(t.search,"create_time",e)},expression:"search.create_time"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.doSearch}},[t._v("查询")]),a("el-button",{attrs:{type:"primary"},on:{click:t.resetSearch}},[t._v("重置")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.leaveList,"tooltip-effect":"dark",border:"",fit:""}},[a("el-table-column",{attrs:{align:"center",label:"序号","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}])}),a("el-table-column",{attrs:{prop:"user_name",align:"center",label:"请假人","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.user_name))]}}])}),a("el-table-column",{attrs:{prop:"type_name",align:"center",label:"请假类型","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.type_name))]}}])}),a("el-table-column",{attrs:{prop:"time_start",align:"center",label:"请假开始时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("timeStampFormat")(e.row.time_start)))]}}])}),a("el-table-column",{attrs:{prop:"time_end",align:"center",label:"请假结束时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("timeStampFormat")(e.row.time_end)))]}}])}),a("el-table-column",{attrs:{prop:"reason",align:"center",label:"请假理由","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.reason))]}}])}),a("el-table-column",{attrs:{prop:"status",align:"center",label:"请假状态","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[-1==e.row.status?[t._v("拒绝")]:t._e(),0==e.row.status?[t._v("待审核")]:t._e(),1==e.row.status?[t._v("同意")]:t._e(),2==e.row.status?[t._v("上报")]:t._e()]}}])}),a("el-table-column",{attrs:{prop:"now_auditor_name",align:"center",label:"审核员","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.now_auditor_name))]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{on:{click:function(a){return t.handleDetail(e.row.vv)}}},[t._v("请假详情")])]}}])})],1),a("el-dialog",{attrs:{title:"请假详情("+t.leaveDetailTotal+"条)",width:"60%",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.leaveDetailList,"tooltip-effect":"dark",border:"",fit:""}},[a("el-table-column",{attrs:{align:"center",label:"序号","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}])}),a("el-table-column",{attrs:{prop:"name",align:"center",label:"审批人","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.name))]}}])}),a("el-table-column",{attrs:{prop:"type_name",align:"center",label:"审批类型","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.type_name))]}}])}),a("el-table-column",{attrs:{prop:"note",align:"center",label:"备注","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.note))]}}])}),a("el-table-column",{attrs:{prop:"created",align:"center",label:"请求审批时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("timeStampFormat")(e.row.created)))]}}])}),a("el-table-column",{attrs:{prop:"updated",align:"center",label:"审批时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("timeStampFormat")(e.row.updated)))]}}])})],1)],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.paginationChange}})],1)},[],!1,null,null,null);e.default=d.exports}}]);