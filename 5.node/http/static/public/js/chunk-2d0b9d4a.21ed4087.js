(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0b9d4a"],{"352d":function(t,e,a){"use strict";a.r(e);a("7f7f");var o=a("cebc"),i=a("e814"),l=a.n(i),n=a("f499"),r=a.n(n),s=(a("386d"),a("333d")),c=a("fa7d"),u=a("b157"),f={name:"leave",components:{Pagination:s.a},data:function(){return{htmlDecode:c.a.htmlDecode,goOutList:[],listQuery:{page:1,limit:10},search:{job:"",staff:"",create_time:""},total:0,detailTotal:0,listLoading:!1,dialogFormVisible:!1,leaveTypeList:[],subJobList:[],subUserList:[],subUserOption:[],goOutDetailList:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]}}},mounted:function(){this.getTypeList(),this.getSubJobList(),this.getSubUserList(),this.getList()},methods:{preview:function(t,e){var a=document.querySelectorAll('img[myPreview="'+e+'"]');this.openPhotoSwipe(t,a)},getTypeList:function(){var t=this;Object(u.j)().then(function(e){t.leaveTypeList=e.data.data.data})},getSubJobList:function(){var t=this;Object(u.a)().then(function(e){t.subJobList=e.data.data.data})},getSubUserList:function(){var t=this;Object(u.b)({job:this.search.job}).then(function(e){t.subUserList=e.data.data.data,t.subUserOption=e.data.data.data})},getList:function(){var t=this;this.listLoading=!0;var e=JSON.parse(r()(this.search));e.create_time&&e.create_time.push&&(e.time_start=l()(e.create_time[0]/1e3),e.time_end=l()(e.create_time[1]/1e3)),delete e.create_time,Object(u.c)(Object(o.a)({},this.listQuery,e)).then(function(e){t.listLoading=!1,t.goOutList=e.data.data.data.lists,t.total=e.data.data.data.total})},paginationChange:function(){this.getList()},doSearch:function(){this.listQuery={page:1,limit:10},this.getList()},resetSearch:function(){this.search={job:"",staff:"",create_time:""},this.getList()},filterUser:function(t){var e=this.subUserList.filter(function(e){return-1!=e.name.indexOf(t)||-1!=e.mobile.indexOf(t)});this.subUserOption=e},handleDetail:function(t){var e=this;Object(u.d)({go_out_id:t}).then(function(t){e.dialogFormVisible=!0,e.goOutDetailList=t.data.data.data.lists,e.detailTotal=t.data.data.data.total})},jobChange:function(){var t=JSON.parse(r()(this.search));t.staff="",this.search=t,this.getSubUserList()}}},p=a("2877"),d=Object(p.a)(f,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-form",{ref:"searchForm",attrs:{inline:!0,model:t.search}},[a("el-form-item",{attrs:{label:"部门"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:t.jobChange},model:{value:t.search.job,callback:function(e){t.$set(t.search,"job",e)},expression:"search.job"}},t._l(t.subJobList,function(e){return a("el-option",{key:e.vv,attrs:{label:t.htmlDecode(e.spacer)+e.name,value:e.vv}})}),1)],1),a("el-form-item",{attrs:{label:"外出人"}},[a("el-select",{attrs:{filterable:"",clearable:"","filter-method":t.filterUser,placeholder:"搜索姓名或电话"},model:{value:t.search.staff,callback:function(e){t.$set(t.search,"staff",e)},expression:"search.staff"}},t._l(t.subUserOption,function(t){return a("el-option",{key:t.vv,attrs:{label:t.name,value:t.vv}})}),1)],1),a("el-form-item",{attrs:{label:"外出时间"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions,"value-format":"timestamp"},model:{value:t.search.create_time,callback:function(e){t.$set(t.search,"create_time",e)},expression:"search.create_time"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.doSearch}},[t._v("查询")]),a("el-button",{attrs:{type:"primary"},on:{click:t.resetSearch}},[t._v("重置")])],1)],1)],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.goOutList,"tooltip-effect":"dark",border:"",fit:""}},[a("el-table-column",{attrs:{align:"center",label:"序号","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}])}),a("el-table-column",{attrs:{prop:"user_name",align:"center",label:"外出人","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.user_name))]}}])}),a("el-table-column",{attrs:{prop:"ideal_goout_time",align:"center",label:"理想外出时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("timeStampFormat")(e.row.ideal_goout_time)))]}}])}),a("el-table-column",{attrs:{prop:"reason",align:"center",label:"外出事由","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.reason))]}}])}),a("el-table-column",{attrs:{prop:"goout_time",align:"center",label:"外出时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("timeStampFormat")(e.row.goout_time)))]}}])}),a("el-table-column",{attrs:{prop:"return_time",align:"center",label:"归来时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("timeStampFormat")(e.row.return_time)))]}}])}),a("el-table-column",{attrs:{align:"center",label:"状态","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.goout_time||e.row.return_time?t._e():a("span",[t._v("待开始")]),e.row.goout_time&&!e.row.return_time?a("span",[t._v("进行中")]):t._e(),e.row.goout_time&&e.row.return_time?a("span",[t._v("已完成")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{on:{click:function(a){return t.handleDetail(e.row.vv)}}},[t._v("外出详情")])]}}])})],1),a("el-dialog",{attrs:{title:"外出详情("+t.detailTotal+"条)",width:"60%",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.goOutDetailList,"tooltip-effect":"dark",border:"",fit:""}},[a("el-table-column",{attrs:{align:"center",label:"序号","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}])}),a("el-table-column",{attrs:{prop:"name",align:"center",label:"打卡人","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.name))]}}])}),a("el-table-column",{attrs:{prop:"type_name",align:"center",label:"打卡类型","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.type_name))]}}])}),a("el-table-column",{attrs:{prop:"address",align:"center",label:"打卡地点","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.address))]}}])}),a("el-table-column",{attrs:{prop:"imgs",align:"center",label:"打卡图片","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.imgs.split(","),function(o,i){return a("img",{key:i,staticStyle:{width:"40px",height:"40px",margin:"0 10px"},style:{cursor:"pointer"},attrs:{src:o,myPreview:"group"+e.$index},on:{click:function(a){return t.preview(i,"group"+e.$index)}}})})}}])}),a("el-table-column",{attrs:{prop:"note",align:"center",label:"备注","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.note))]}}])}),a("el-table-column",{attrs:{prop:"created",align:"center",label:"打卡时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("timeStampFormat")(e.row.created)))]}}])})],1)],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.paginationChange}})],1)},[],!1,null,null,null);e.default=d.exports}}]);