(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0bff3e"],{"405a":function(e,t,r){"use strict";r.r(t);var o=r("cebc"),a=r("b775");var l=r("5f87"),i=r("127f"),s={name:"carousel",data:function(){return{list:[],bannerTypes:[],dialogFormVisible:!1,form:{sort:"",type:"",name:"",title:"",position:"",image:"",uri:""},rules:{sort:[{required:!0,message:"排序值不能为空",trigger:"blur"},{pattern:/^(\-){0,1}(([1-9][0-9]*|0)|(([1-9][0-9]*|0)\.[0-9]+))$/,message:"排序只能为数字"}],type:[{required:!0,message:"类型不能为空",trigger:"blur"}],name:[{required:!0,message:"名称不能为空",trigger:"blur"}],title:[{required:!0,message:"标题不能为空",trigger:"blur"}],position:[{required:!0,message:"位置不能为空",trigger:"blur"}],image:[{required:!0,message:"轮播图不能为空",trigger:"blur"}],uri:[{required:!0,message:"跳转链接不能为空",trigger:"blur"}]},formLabelWidth:"120px",token:{"X-Token":Object(l.a)()}}},created:function(){this.formCopy=Object(o.a)({},this.form)},mounted:function(){this.getList()},filters:{getTypeText:function(e,t){var r=t.filter(function(t,r){return t.value===e});return r[0]?r[0].text:e}},methods:{getList:function(){var e=this;Object(a.a)({url:"/conf/banner/lists",method:"post"}).then(function(t){var r=t.data.data;e.list=r.data;for(var o=[],a=0;a<r.type.length;a++)o[a]={},o[a].text=r.type[a].reality_value,o[a].value=r.type[a].database_value;e.bannerTypes=o})},handleEdit:function(e){this.form=Object(o.a)({},e),this.dialogFormVisible=!0},addOrUpdate:function(e){var t=this;this.$refs[e].validate(function(e){var r;e&&(t.form.vv?(r=t.form,Object(a.a)({url:"/conf/banner/edit",method:"post",data:r})):function(e){return Object(a.a)({url:"/conf/banner/add",method:"post",data:e})}(t.form)).then(function(e){t.$message({showClose:!0,message:e.data.msg,type:"success"}),t.getList(),t.resetForm()})})},handleDel:function(e){var t=this;this.$confirm("你确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var r;(r={vv:e},Object(a.a)({url:"/conf/banner/del",method:"post",data:r})).then(function(e){t.$message({showClose:!0,message:e.data.msg,type:"success"}),t.getList()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},fnUploadRequest:function(e){i.a.ossUploadFile(e)},handleImageSuccess:function(e,t){this.form.image=e.requestUrls[0],this.$message({showClose:!0,message:"上传成功",type:-1===e.code?"error":"success"})},beforeImageUpload:function(e){var t=0===e.type.indexOf("image"),r=e.size/1024/1024<20;return t||this.$message.error("只能上传图片!"),r||this.$message.error("上传图片大小不能超过 20MB!"),t&&r},filterTag:function(e,t){return t.type===e},handleClose:function(e){this.resetForm(),e()},closeForm:function(e){this.resetForm()},resetForm:function(){this.dialogFormVisible=!1,this.$refs.ruleForm.resetFields(),this.form=Object(o.a)({},this.formCopy)},preview:function(e){var t=document.querySelectorAll('img[myPreview="'+e+'"]');this.openPhotoSwipe(0,t)}}},n=r("2877"),m=Object(n.a)(s,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"filter-container"},[r("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加")])],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list}},[r("el-table-column",{attrs:{align:"center",label:"排序",prop:"sort"}}),r("el-table-column",{attrs:{align:"center",label:"名称",prop:"name"}}),r("el-table-column",{attrs:{align:"center",label:"标题",prop:"title"}}),r("el-table-column",{attrs:{align:"center",label:"位置",prop:"position"}}),r("el-table-column",{attrs:{align:"center",label:"轮播图"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("img",{staticStyle:{width:"80px",height:"80px"},style:{cursor:"pointer"},attrs:{src:0===t.row.image.indexOf("http")?t.row.image:e.imgUploadUrl+t.row.image,onerror:"http://"+t.row.image,preview:Math.random()}})]}}])}),r("el-table-column",{attrs:{align:"center",label:"跳转地址",prop:"uri"}}),r("el-table-column",{attrs:{prop:"type",align:"center",label:"类型",filters:e.bannerTypes,"filter-method":e.filterTag,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{"disable-transitions":""}},[e._v(e._s(e._f("getTypeText")(t.row.type,e.bannerTypes)))])]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.handleEdit(t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return e.handleDel(t.row.vv)}}},[e._v("删除")])]}}])})],1),r("el-dialog",{attrs:{title:e.form.vv?"编辑":"新增",visible:e.dialogFormVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"排序","label-width":e.formLabelWidth,prop:"sort"}},[r("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"5","show-word-limit":""},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),r("el-form-item",{attrs:{label:"类型","label-width":e.formLabelWidth,prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.bannerTypes,function(e){return r("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})}),1)],1),r("el-form-item",{attrs:{label:"名称","label-width":e.formLabelWidth,prop:"name"}},[r("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"32","show-word-limit":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"标题","label-width":e.formLabelWidth,prop:"title"}},[r("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"100","show-word-limit":""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),r("el-form-item",{attrs:{label:"位置","label-width":e.formLabelWidth,prop:"position"}},[r("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"32","show-word-limit":""},model:{value:e.form.position,callback:function(t){e.$set(e.form,"position",t)},expression:"form.position"}})],1),r("el-form-item",{attrs:{label:"轮播图","label-width":e.formLabelWidth,prop:"image"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"",headers:e.token,"show-file-list":!1,accept:"image/*","http-request":e.fnUploadRequest,"on-success":e.handleImageSuccess,"before-upload":e.beforeImageUpload}},[e.form.image?r("img",{staticClass:"avatar",attrs:{src:e.form.image,myPreview:"image"}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e.form.image?r("el-button",{staticClass:"preview",attrs:{size:"mini"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.preview("image")}}},[e._v("点击预览")]):e._e()],1)],1),r("el-form-item",{attrs:{label:"跳转地址","label-width":e.formLabelWidth,prop:"uri"}},[r("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.form.uri,callback:function(t){e.$set(e.form,"uri",t)},expression:"form.uri"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){return e.closeForm("ruleForm")}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOrUpdate("ruleForm")}}},[e._v("确 定")])],1)],1)],1)},[],!1,null,null,null);t.default=m.exports}}]);