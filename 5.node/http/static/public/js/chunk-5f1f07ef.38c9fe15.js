(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5f1f07ef"],{"03ec":function(t,e,o){"use strict";var n=o("27e6");o.n(n).a},"27e6":function(t,e,o){},fd98:function(t,e,o){"use strict";o.r(e);o("7f7f"),o("a481");var n=o("f499"),i=o.n(n),r=o("f095"),a=o("7026"),l=o.n(a),s=(o("542c"),{name:"Job",components:{treeSelect:l.a},data:function(){return{jobList:[],listLoading:!1,dialogFormVisible:!1,formLabelWidth:"120px",rules:{parent:[{required:!0,message:"请选择上级",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}]},options:[],optionsAll:[],form:{parent:0,name:"",is_item:0}}},created:function(){this.formCopy=JSON.parse(i()(this.form))},mounted:function(){this.getJobData()},methods:{getJobData:function(){var t=this;this.listLoading=!0,Object(r.j)().then(function(e){for(var o=e.data.data.data,n=0;n<o.length;n++)o[n].name=o[n].name.replace(o[n].spacer+" ","");t.jobList=o,t.options=t.generateOption(o),t.optionsAll=t.options,t.listLoading=!1})},handleClose:function(t){this.resetForm(),t()},closeForm:function(){this.resetForm()},resetForm:function(){this.dialogFormVisible=!1,this.$refs.ruleForm.resetFields(),this.form=JSON.parse(i()(this.formCopy))},addOrUpdateRole:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;(e.form.vv?Object(r.o)(e.form):Object(r.b)(e.form)).then(function(t){e.$message({showClose:!0,message:t.data.msg,type:"success"}),e.resetForm(),e.getJobData()})})},editJob:function(t){for(var e in this.form)this.form[e]=t[e];this.form.vv=t.vv;var o=this.walkOption(this.jobList,t.id),n=this.jobList.filter(function(t,e){return-1==o.indexOf(e)});this.options=this.generateOption(n),this.dialogFormVisible=!0},deleteJobById:function(t){var e=this;this.$confirm("你确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r.g)({vv:t}).then(function(t){e.$message({showClose:!0,message:t.data.msg,type:"success"}),e.getJobData()})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},walkOption:function(t,e){var o=[];!function e(n){for(var i=0;i<t.length;i++){var r=t[i];r.parent==n&&(e(r.id),o.push(i))}}(e);for(var n=0;n<t.length;n++)t[n].vv==e&&o.push(n);return o},generateOption:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=0;o<t.length;o++)e[o]={},e[o].id=t[o].id,e[o].label=" "+t[o].spacer+" "+t[o].name;return e}}}),c=(o("03ec"),o("2877")),f=Object(c.a)(s,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("div",{staticClass:"filter-container"},[o("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){t.dialogFormVisible=!0,t.options=t.optionsAll}}},[t._v("添加")])],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.jobList,"tooltip-effect":"dark",border:"",fit:""}},[o("el-table-column",{attrs:{align:"center",label:"序号","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}])}),o("el-table-column",{attrs:{prop:"name",align:"center",label:"名称","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",{staticClass:"job_name",domProps:{innerHTML:t._s(" "+e.row.spacer+" "+e.row.name)}})]}}])}),o("el-table-column",{attrs:{prop:"name",align:"center",label:"是否可新建项目","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s("1"==e.row.is_item?"是":"否")+"\n      ")]}}])}),o("el-table-column",{attrs:{label:"操作",align:"center",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"info",icon:"el-icon-edit"},on:{click:function(o){return t.editJob(e.row)}}},[t._v("编辑")]),o("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(o){return t.deleteJobById(e.row.vv)}}},[t._v("删除")])]}}])})],1),o("el-dialog",{attrs:{title:t.form.vv?"编辑部门":"新增部门",visible:t.dialogFormVisible,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[o("el-form",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules}},[o("el-form-item",{attrs:{label:"上级","label-width":t.formLabelWidth,prop:"parent"}},[o("treeSelect",{attrs:{multiple:!1,options:t.options},scopedSlots:t._u([{key:"value-label",fn:function(e){var n=e.node;return o("div",{domProps:{innerHTML:t._s(n.label)}})}},{key:"option-label",fn:function(e){var n=e.node;return o("label",{},[o("span",{domProps:{innerHTML:t._s(n.label)}})])}}]),model:{value:t.form.parent,callback:function(e){t.$set(t.form,"parent",e)},expression:"form.parent"}})],1),o("el-form-item",{attrs:{label:"名称","label-width":t.formLabelWidth,prop:"name"}},[o("el-input",{attrs:{autocomplete:"off",maxlength:"64","show-word-limit":""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:"是否可新建项目","label-width":t.formLabelWidth,prop:"is_item"}},[o("el-switch",{staticStyle:{display:"block"},attrs:{"active-text":"是","active-value":1,"inactive-text":"否","inactive-value":0},model:{value:t.form.is_item,callback:function(e){t.$set(t.form,"is_item",e)},expression:"form.is_item"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.closeForm}},[t._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addOrUpdateRole("ruleForm")}}},[t._v("确 定")])],1)],1)],1)},[],!1,null,"81c71202",null);e.default=f.exports}}]);