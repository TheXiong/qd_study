(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6936e616"],{"16e9":function(t,e,a){"use strict";var s=a("92e1");a.n(s).a},"7c64":function(t,e,a){"use strict";a.r(e);a("7f7f"),a("28a5");var s=a("cebc"),o=a("aa2a"),n=a("0ced"),i=a("94cf"),r=(a("127f"),a("333d")),c=a("eee9"),l=a("9e9e"),u=a("f38e"),m=a("5880"),d={components:{VDistpicker:n.a,Tinymce:i.a,Pagination:r.a,ImgMutiUpload:c.a,VideoUpload:l.a,docMutiUpload:u.a},data:function(){var t=this;return{newsData:[],newsClassData:[],dialogFormVisible:!1,listQuery:{page:1,limit:10},searchForm:{search:"",class:""},total:0,dataForm:{type:"",content_type:"",title:"",show_case:[],content:"",province:"",city:"",district:"",address:""},rules:{type:[{required:!0,message:"请选择类型",trigger:"blur"}],content_type:[{required:!0,message:"请选择内容类型",trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],show_case:[{validator:function(t,e,a){return 0==e.length&&a(),1==e.length&&a(),a(new Error("展示图只能1张"))},trigger:"blur"}],content:[{required:!0,validator:function(e,a,s){1==t.dataForm.content_type&&(a.length>0?s():s(new Error("请上传文档"))),2==t.dataForm.content_type&&(a.length>0?a.length<=6?s():s(new Error("图片最多6张")):s(new Error("请上传图片"))),3==t.dataForm.content_type&&(a.length>0?s():s(new Error("请上传视频"))),4==t.dataForm.content_type&&(a?s():s(new Error("内容不能为空")))},trigger:"blur"}],province:[{required:!0,message:"请选择地区",trigger:"blur"}],city:[{required:!0,message:"请选择地区",trigger:"blur"}],district:[{required:!0,message:"请选择地区",trigger:"blur"}],address:[{required:!0,message:"请选择地区",trigger:"blur"}]},newsStatus:[]}},mounted:function(){this.getList(),this.getNewsClassList(),this.getStatus()},computed:Object(s.a)({},Object(m.mapGetters)(["is_root"])),filters:{getStatusName:function(t,e){var a=e.filter(function(e){return e.database_value==t});return a.length>0?a[0].reality_value:""},getClassName:function(t,e){var a=e.filter(function(e){return e.vv==t});return a.length>0?a[0].class_name:""}},methods:{getList:function(){var t=this;Object(o.j)(Object(s.a)({},this.listQuery,this.searchForm)).then(function(e){t.newsData=e.data.data.data.lists,t.total=e.data.data.data.total})},getNewsClassList:function(){var t=this;Object(o.g)().then(function(e){t.newsClassData=e.data.data.data})},getStatus:function(){var t=this;Object(o.b)().then(function(e){t.newsStatus=e.data.data.data})},handleCreate:function(){var t=this;this.dataForm={type:"",content_type:"",title:"",show_case:[],content:"",province:"",city:"",district:"",address:""},this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},handleEdit:function(t){var e=this;Object(o.l)({news_id:t.vv}).then(function(a){var s=a.data.data.row,o=1==s.class||2==s.class||3==s.class?s.content?s.content.split(";"):[]:s.content;e.dataForm={vv:t.vv,type:s.is_official?3:s.is_public?2:1,content_type:s.class,title:s.title,show_case:s.show_case?s.show_case.split(";"):[],content:o,province:s.province,city:s.city,district:s.district,address:s.address,status:s.status,is_public:s.is_public},e.dialogFormVisible=!0,e.$nextTick(function(){e.$refs.dataForm.clearValidate(),e.$refs.tinymce&&e.$refs.tinymce.setContent(o)})})},createData:function(){var t=this;this.$refs.dataForm.validate(function(e){if(e){if(1==t.dataForm.content_type){var a=t.dataForm.content[0].slice(t.dataForm.content[0].lastIndexOf("/")+1),n=a.slice(a.lastIndexOf(".")+1);"doc"!=n&&"docx"!=n||(t.dataForm.show_case=["http://lejubang.oss-cn-shenzhen.aliyuncs.com/admin/20190904/u%3D100456567%2C189960518%26fm%3D26%26gp%3D0_20190904105451.jpg?x-oss-process=image/format,jpg/quality,q_80"]),"xls"!=n&&"xlsx"!=n||(t.dataForm.show_case=["http://lejubang.oss-cn-shenzhen.aliyuncs.com/admin/20190904/%E4%B8%8B%E8%BD%BD_20190904105643.jpg?x-oss-process=image/format,jpg/quality,q_80"]),"ppt"!=n&&"pptx"!=n||(t.dataForm.show_case=["http://lejubang.oss-cn-shenzhen.aliyuncs.com/admin/20190904/%E4%B8%8B%E8%BD%BD%20(2)_20190904105800.jpg?x-oss-process=image/format,jpg/quality,q_80"]),"pdf"==n&&(t.dataForm.show_case=["http://lejubang.oss-cn-shenzhen.aliyuncs.com/admin/20190904/u%3D1568611217%2C60571272%26fm%3D26%26gp%3D0_20190904105554.jpg?x-oss-process=image/format,jpg/quality,q_80"]),"txt"==n&&(t.dataForm.show_case=["http://lejubang.oss-cn-shenzhen.aliyuncs.com/admin/20190904/%E4%B8%8B%E8%BD%BD%20(1)_20190904105620.jpg?x-oss-process=image/format,jpg/quality,q_80"])}Object(o.c)(Object(s.a)({},t.dataForm,{class:t.dataForm.content_type,is_public:1==t.dataForm.type?0:1,is_official:3==t.dataForm.type?1:0})).then(function(e){t.getList(),t.dialogFormVisible=!1,t.$message({showClose:!0,message:e.data.msg,type:"success"})})}})},updateData:function(){var t=this;this.$refs.dataForm.validate(function(e){if(e){if(1==t.dataForm.content_type){var a=t.dataForm.content[0].slice(t.dataForm.content[0].lastIndexOf("/")+1),n=a.slice(a.lastIndexOf(".")+1);"doc"!=n&&"docx"!=n||(t.dataForm.show_case=["http://lejubang.oss-cn-shenzhen.aliyuncs.com/admin/20190904/u%3D100456567%2C189960518%26fm%3D26%26gp%3D0_20190904105451.jpg?x-oss-process=image/format,jpg/quality,q_80"]),"xls"!=n&&"xlsx"!=n||(t.dataForm.show_case=["http://lejubang.oss-cn-shenzhen.aliyuncs.com/admin/20190904/%E4%B8%8B%E8%BD%BD_20190904105643.jpg?x-oss-process=image/format,jpg/quality,q_80"]),"ppt"!=n&&"pptx"!=n||(t.dataForm.show_case=["http://lejubang.oss-cn-shenzhen.aliyuncs.com/admin/20190904/%E4%B8%8B%E8%BD%BD%20(2)_20190904105800.jpg?x-oss-process=image/format,jpg/quality,q_80"]),"pdf"==n&&(t.dataForm.show_case=["http://lejubang.oss-cn-shenzhen.aliyuncs.com/admin/20190904/u%3D1568611217%2C60571272%26fm%3D26%26gp%3D0_20190904105554.jpg?x-oss-process=image/format,jpg/quality,q_80"]),"txt"==n&&(t.dataForm.show_case=["http://lejubang.oss-cn-shenzhen.aliyuncs.com/admin/20190904/%E4%B8%8B%E8%BD%BD%20(1)_20190904105620.jpg?x-oss-process=image/format,jpg/quality,q_80"])}Object(o.i)(Object(s.a)({},t.dataForm,{class:t.dataForm.content_type,is_public:1==t.dataForm.type?0:1,is_official:3==t.dataForm.type?1:0})).then(function(e){t.getList(),t.dialogFormVisible=!1,t.$message({showClose:!0,message:e.data.msg,type:"success"})})}})},districtSelected:function(t){this.dataForm.province=t.province.code+"",this.dataForm.city=t.city.code+"",this.dataForm.district=t.area.code+"",this.dataForm.address=(t.province.name||"")+(t.city.name||"")+(t.area.name||"")},contentTypeChange:function(t){this.dataForm.content=1==t||2==t||3==t?[]:""},paginationChange:function(){this.getList()},preview:function(t,e){var a=document.querySelectorAll('img[myPreview="'+t+'"]');this.openPhotoSwipe(e,a)},handlePublish:function(t){var e=this;this.$confirm("是否确定要发布该动态吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.k)({vv:t.vv}).then(function(t){e.getList(),e.$message({showClose:!0,message:t.data.msg,type:"success"})})}).catch(function(){e.$message({type:"info",message:"已取消发布"})})},handleApplyPublish:function(t){var e=this;this.$confirm("是否确定要申请发布该动态吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.d)({vv:t.vv}).then(function(t){e.getList(),e.$message({showClose:!0,message:t.data.msg,type:"success"})})}).catch(function(){e.$message({type:"info",message:"已取消申请"})})},handleUnpublish:function(t){var e=this;this.$confirm("您确定要下架改资讯吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.e)({vv:t.vv}).then(function(t){e.getList(),e.$message({showClose:!0,message:t.data.msg,type:"success"})})}).catch(function(){e.$message({type:"info",message:"已取消下架"})})},handleDelete:function(t){var e=this;this.$confirm("您确定要删除改资讯吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.h)({vv:t.vv}).then(function(t){e.getList(),e.$message({showClose:!0,message:t.data.msg,type:"success"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},doSearch:function(){this.listQuery={page:1,limit:10},this.getList()},resetSearch:function(){this.listQuery={page:1,limit:10},this.searchForm={search:"",class:""},this.getList()}}},p=(a("16e9"),a("2877")),f=Object(p.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-form",{ref:"searchForm",attrs:{inline:!0,model:t.searchForm}},[a("el-form-item",{attrs:{label:"内容类型"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.searchForm.class,callback:function(e){t.$set(t.searchForm,"class",e)},expression:"searchForm.class"}},t._l(t.newsClassData,function(t){return a("el-option",{key:t.vv,attrs:{label:t.class_name,value:t.vv}})}),1)],1),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:t.searchForm.search,callback:function(e){t.$set(t.searchForm,"search",e)},expression:"searchForm.search"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.doSearch}},[t._v("查询")]),a("el-button",{attrs:{type:"primary"},on:{click:t.resetSearch}},[t._v("重置")])],1)],1),1!=t.is_root?a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.handleCreate}},[t._v("创建")]):t._e()],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.newsData}},[a("el-table-column",{attrs:{align:"center",label:"序号","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s((t.listQuery.page-1)*t.listQuery.limit+e.$index+1))]}}])}),a("el-table-column",{attrs:{align:"center",label:"标题","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.title))]}}])}),a("el-table-column",{attrs:{align:"center",label:"地区","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.address))]}}])}),a("el-table-column",{attrs:{align:"center",label:"类型","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.is_public?a("span",[t._v("内部")]):t._e(),1==e.row.is_public&&0==e.row.is_official?a("span",[t._v("行业")]):t._e(),1==e.row.is_public&&1==e.row.is_official?a("span",[t._v("官方")]):t._e()]}}])}),a("el-table-column",{attrs:{align:"center",label:"内容类型","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("getClassName")(e.row.class,t.newsClassData)))]}}])}),a("el-table-column",{attrs:{align:"center",label:"创建时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("timeStampFormat")(e.row.created)))]}}])}),a("el-table-column",{attrs:{align:"center",label:"状态","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.status&&0==e.row.is_public||1==e.row.is_official&&0==e.row.status?a("span",[t._v("待发布")]):t._e(),0==e.row.status&&1==e.row.is_public&&-999==e.row.check_status&&1!=e.row.is_official?a("span",[t._v("待申请")]):t._e(),0==e.row.status&&1==e.row.is_public&&-999!=e.row.check_status?a("span",[t._v("\n          "+t._s(0==e.row.check_status?"审核中":-1==e.row.check_status?"审核不通过("+e.row.reason+")":"待申请")+"\n        ")]):t._e(),1==e.row.status?a("span",[t._v("已发布")]):t._e(),2==e.row.status?a("span",[t._v("审核不通过"+t._s("("+e.row.reason+")"))]):t._e(),-1==e.row.status?a("span",[t._v("已删除")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status&&1!=t.is_root&&0!=e.row.is_public?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleEdit(e.row)}}},[t._v("查看")]):t._e(),1==e.row.status&&0!=e.row.is_public||1==t.is_root?t._e():a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleEdit(e.row)}}},[t._v("编辑")]),(0==e.row.is_public&&0==e.row.status||1==e.row.is_official&&0==e.row.status)&&1!=t.is_root?a("el-button",{attrs:{size:"mini",type:"paimary"},on:{click:function(a){return t.handlePublish(e.row)}}},[t._v("发布")]):t._e(),(1!=e.row.is_official&&1==e.row.is_public&&0==e.row.status&&0!=e.row.check_status||2==e.row.status)&&1!=t.is_root?a("el-button",{attrs:{size:"mini",type:"paimary"},on:{click:function(a){return t.handleApplyPublish(e.row)}}},[t._v("申请发布")]):t._e(),1==e.row.status&&1!=t.is_root?a("el-button",{attrs:{size:"mini",type:"paimary"},on:{click:function(a){return t.handleUnpublish(e.row)}}},[t._v("下架")]):t._e(),1!=t.is_root?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")]):t._e()]}}])})],1),a("el-dialog",{attrs:{title:void 0!==t.dataForm.vv?"编辑动态":"创建动态",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",attrs:{rules:t.rules,model:t.dataForm,"status-icon":"","label-position":"top","label-width":"110px"}},[a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-radio-group",{model:{value:t.dataForm.type,callback:function(e){t.$set(t.dataForm,"type",e)},expression:"dataForm.type"}},[a("el-radio",{attrs:{label:1,disabled:!!+t.$store.getters.is_root}},[t._v("内部")]),a("el-radio",{attrs:{label:2}},[t._v("行业")]),1==t.$store.getters.is_official||1==t.$store.getters.is_root?a("el-radio",{attrs:{label:3}},[t._v("官方")]):t._e()],1)],1),a("el-form-item",{attrs:{label:"内容类型",prop:"content_type"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.contentTypeChange},model:{value:t.dataForm.content_type,callback:function(e){t.$set(t.dataForm,"content_type",e)},expression:"dataForm.content_type"}},t._l(t.newsClassData,function(t){return a("el-option",{key:t.vv,attrs:{label:t.class_name,value:t.vv}})}),1)],1),a("el-form-item",{attrs:{label:"地区",prop:"address"}},[a("v-distpicker",{attrs:{province:t.dataForm.province,city:t.dataForm.city,area:t.dataForm.district},on:{selected:t.districtSelected}})],1),a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{maxlength:"200","show-word-limit":""},model:{value:t.dataForm.title,callback:function(e){t.$set(t.dataForm,"title",e)},expression:"dataForm.title"}})],1),4==t.dataForm.content_type?a("el-form-item",{attrs:{label:"展示图",prop:"show_case"}},[a("ImgMutiUpload",{attrs:{imgList:t.dataForm.show_case}})],1):t._e(),a("el-form-item",{attrs:{label:"内容",prop:"content"}},[2==t.dataForm.content_type?a("ImgMutiUpload",{attrs:{imgList:t.dataForm.content}}):t._e(),3==t.dataForm.content_type?a("VideoUpload",{attrs:{video:t.dataForm.content}}):t._e(),1==t.dataForm.content_type?a("docMutiUpload",{attrs:{docmentList:t.dataForm.content}}):t._e(),4==t.dataForm.content_type?a("tinymce",{ref:"tinymce",attrs:{height:550},model:{value:t.dataForm.content,callback:function(e){t.$set(t.dataForm,"content",e)},expression:"dataForm.content"}}):t._e()],1)],1),t.dataForm.status&&1==t.dataForm.status&&0!=t.dataForm.is_public?t._e():a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),void 0===t.dataForm.vv?a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("确定")]):a("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v("确定")])],1)],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.paginationChange}})],1)},[],!1,null,null,null);e.default=f.exports},"92e1":function(t,e,a){}}]);