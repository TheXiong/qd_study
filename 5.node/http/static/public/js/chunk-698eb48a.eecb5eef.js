(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-698eb48a"],{"28b0":function(t,e,i){},"3c61":function(t,e,i){},"4b94":function(t,e,i){"use strict";var a=i("3c61");i.n(a).a},"7f1e":function(t,e,i){"use strict";var a=i("a768");i.n(a).a},a768:function(t,e,i){},bdfb:function(t,e,i){"use strict";var a=i("28b0");i.n(a).a},cfb7:function(t,e,i){"use strict";i.r(e);i("7f7f"),i("28a5");var a=i("cebc"),s=i("0ced"),n=(i("ac6a"),i("c5f6"),i("795b")),o=i.n(n),r=i("a4bb"),l=i.n(r),c={name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[]}},methods:{checkAllSuccess:function(){var t=this;return l()(this.listObj).every(function(e){return t.listObj[e].hasSuccess})},handleSubmit:function(){var t=this,e=l()(this.listObj).map(function(e){return t.listObj[e]});this.checkAllSuccess()?(this.$emit("successCBK",e),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("请等待所有图片上传成功 或 出现了网络问题，请刷新页面重新上传！")},handleSuccess:function(t,e){for(var i=e.uid,a=l()(this.listObj),s=0,n=a.length;s<n;s++)if(this.listObj[a[s]].uid===i)return this.listObj[a[s]].url=t.files.file,void(this.listObj[a[s]].hasSuccess=!0)},handleRemove:function(t){for(var e=t.uid,i=l()(this.listObj),a=0,s=i.length;a<s;a++)if(this.listObj[i[a]].uid===e)return void delete this.listObj[i[a]]},beforeUpload:function(t){var e=this,i=window.URL||window.webkitURL,a=t.uid;return this.listObj[a]={},new o.a(function(s,n){var o=new Image;o.src=i.createObjectURL(t),o.onload=function(){e.listObj[a]={hasSuccess:!1,uid:t.uid,width:this.width,height:this.height}},s(!0)})}}},u=(i("4b94"),i("2877")),d=Object(u.a)(c,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-container"},[i("el-button",{style:{background:t.color,borderColor:t.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("上传图片\n  ")]),i("el-dialog",{attrs:{visible:t.dialogVisible,"append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-upload",{staticClass:"editor-slide-upload",attrs:{multiple:!0,"file-list":t.fileList,"show-file-list":!0,"on-remove":t.handleRemove,"on-success":t.handleSuccess,"before-upload":t.beforeUpload,action:"https://httpbin.org/post","list-type":"picture-card"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确 定")])],1)],1)},[],!1,null,"297d00d3",null).exports,m=["advlist anchor autolink autosave code codesample directionality  fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textpattern visualblocks visualchars wordcount toc"],h=["styleselect formatselect fontselect fontsizeselect forecolor backcolor | bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | bullist bullist numlist | outdent indent blockquote | subscript superscript | undo redo removeformat | link hr image media table wordcount toc"],f={name:"Tinymce",components:{editorImage:d},props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:Number,required:!1,default:360}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1}},watch:{value:function(t){var e=this;!this.hasChange&&this.hasInit&&this.$nextTick(function(){return window.tinymce.get(e.tinymceId).setContent(t||"")})},language:function(){var t=this;this.destroyTinymce(),this.$nextTick(function(){return t.initTinymce()})}},mounted:function(){this.initTinymce()},activated:function(){this.initTinymce()},deactivated:function(){this.destroyTinymce()},destroyed:function(){this.destroyTinymce()},methods:{initTinymce:function(){var t=this,e=this;window.tinymce.init({language:"zh_CN",selector:"#".concat(this.tinymceId),height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:h,menubar:this.menubar,plugins:m,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:function(i){e.value&&i.setContent(e.value),e.hasInit=!0,i.on("NodeChange Change KeyUp SetContent",function(){t.hasChange=!0,t.$emit("input",i.getContent())})},setup:function(t){t.on("FullscreenStateChanged",function(t){e.fullscreen=t.state})}})},destroyTinymce:function(){var t=window.tinymce.get(this.tinymceId);this.fullscreen&&t.execCommand("mceFullScreen"),t&&t.destroy()},setContent:function(t){window.tinymce.get(this.tinymceId).setContent(t)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(t){var e=this;t.forEach(function(t){window.tinymce.get(e.tinymceId).insertContent('<img class="wscnph" src="'.concat(t.url,'" >'))})}}},p=(i("bdfb"),i("7f1e"),Object(u.a)(f,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tinymce-container editor-container",class:{fullscreen:this.fullscreen}},[e("textarea",{staticClass:"tinymce-textarea",attrs:{id:this.tinymceId}}),e("div",{staticClass:"editor-custom-btn-container"},[e("editorImage",{staticClass:"editor-upload-btn",attrs:{color:"#1890ff"},on:{successCBK:this.imageSuccessCBK}})],1)])},[],!1,null,"137ad1aa",null).exports),b=i("eee9"),g=i("9e9e"),v=i("f38e"),y=i("333d"),_=i("5880"),w=i("aa2a"),k={components:{VDistpicker:s.a,Tinymce:p,Pagination:y.a,ImgMutiUpload:b.a,VideoUpload:g.a,docMutiUpload:v.a},data:function(){return{newsCheckData:[],newsClassData:[],dialogFormVisible:!1,total:0,listQuery:{page:1,limit:10},dataForm:{type:"",content_type:"",title:"",show_case:[],content:"",province:"",city:"",district:"",address:""},rules:{type:[{required:!0,message:"请选择类型",trigger:"blur"}],content_type:[{required:!0,message:"请选择内容类型",trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],show_case:[],content:[{required:!0,message:"内容不能为空",trigger:"blur"}],province:[{required:!0,message:"请选择地区",trigger:"blur"}],city:[{required:!0,message:"请选择地区",trigger:"blur"}],district:[{required:!0,message:"请选择地区",trigger:"blur"}],address:[{required:!0,message:"请选择地区",trigger:"blur"}]},checkRow:null,showCheckReason:!1,reasonForm:{reason:""},reasonRule:{reason:[{required:!0,message:"请输入未通过原因",trigger:"blur"}]},searchForm:{search:"",class:""}}},mounted:function(){this.getList(),this.getNewsClassList()},computed:Object(a.a)({},Object(_.mapGetters)(["is_root"])),filters:{getClassName:function(t,e){var i=e.filter(function(e){return e.vv==t});return i.length>0?i[0].class_name:""}},methods:{getList:function(){var t=this;Object(w.a)(Object(a.a)({},this.listQuery,this.searchForm)).then(function(e){t.newsCheckData=e.data.data.data.lists,t.total=e.data.data.data.total})},getNewsClassList:function(){var t=this;Object(w.g)().then(function(e){t.newsClassData=e.data.data.data})},handleEdit:function(t){var e=this;Object(w.l)({news_id:t.vv}).then(function(i){var a=i.data.data.row;e.dataForm={vv:t.vv,type:a.is_official?3:a.is_public?2:1,content_type:a.class,title:a.title,show_case:a.show_case?a.show_case.split(";"):[],content:1==a.class||2==a.class||3==a.class?a.content?a.content.split(";"):[]:a.content,province:a.province,city:a.city,district:a.district,address:a.address},e.dialogFormVisible=!0,e.$nextTick(function(){e.$refs.dataForm.clearValidate()})})},districtSelected:function(t){this.dataForm.province=t.province.code+"",this.dataForm.city=t.city.code+"",this.dataForm.district=t.area.code+"",this.dataForm.address=(t.province.name||"")+(t.city.name||"")+(t.area.name||"")},paginationChange:function(){this.getList()},handlePass:function(t){var e=this;this.$confirm("确定要通过该资讯的审核吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(w.f)({check_id:t.check_id,status:1,reason:""}).then(function(t){e.getList(),e.$message({showClose:!0,message:t.data.msg,type:"success"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleUnpass:function(t){this.checkRow=t,this.showCheckReason=!0,this.reasonForm={reason:""}},submitUnpass:function(){var t=this;Object(w.f)({check_id:this.checkRow.check_id,status:-1,reason:this.reasonForm.reason}).then(function(e){t.getList(),t.showCheckReason=!1,t.$message({showClose:!0,message:e.data.msg,type:"success"})})},doSearch:function(){this.listQuery={page:1,limit:10},this.getList()},resetSearch:function(){this.listQuery={page:1,limit:10},this.searchForm={search:"",class:""},this.getList()}}},F=Object(u.a)(k,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-form",{ref:"searchForm",attrs:{inline:!0,model:t.searchForm}},[i("el-form-item",{attrs:{label:"内容类型"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.searchForm.class,callback:function(e){t.$set(t.searchForm,"class",e)},expression:"searchForm.class"}},t._l(t.newsClassData,function(t){return i("el-option",{key:t.vv,attrs:{label:t.class_name,value:t.vv}})}),1)],1),i("el-form-item",{attrs:{label:"标题"}},[i("el-input",{model:{value:t.searchForm.search,callback:function(e){t.$set(t.searchForm,"search",e)},expression:"searchForm.search"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:t.doSearch}},[t._v("查询")]),i("el-button",{attrs:{type:"primary"},on:{click:t.resetSearch}},[t._v("重置")])],1)],1)],1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.newsCheckData}},[i("el-table-column",{attrs:{align:"center",label:"序号","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s((t.listQuery.page-1)*t.listQuery.limit+e.$index+1))]}}])}),i("el-table-column",{attrs:{align:"center",label:"标题","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.title))]}}])}),i("el-table-column",{attrs:{align:"center",label:"地区","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.address))]}}])}),i("el-table-column",{attrs:{align:"center",label:"内容类型","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("getClassName")(e.row.class,t.newsClassData)))]}}])}),i("el-table-column",{attrs:{align:"center",label:"创建时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("timeStampFormat")(e.row.created)))]}}])}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[1!=t.is_root?i("el-button",{attrs:{size:"mini"},on:{click:function(i){return t.handleEdit(e.row)}}},[t._v("查看")]):t._e(),1!=t.is_root?i("el-button",{attrs:{size:"mini"},on:{click:function(i){return t.handlePass(e.row)}}},[t._v("通过")]):t._e(),1!=t.is_root?i("el-button",{attrs:{size:"mini"},on:{click:function(i){return t.handleUnpass(e.row)}}},[t._v("不通过")]):t._e()]}}])})],1),i("el-dialog",{attrs:{title:void 0!==t.dataForm.vv?"编辑动态":"创建动态",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{ref:"dataForm",attrs:{rules:t.rules,model:t.dataForm,"status-icon":"","label-position":"top","label-width":"110px"}},[i("el-form-item",{attrs:{label:"类型",prop:"type"}},[i("el-radio-group",{model:{value:t.dataForm.type,callback:function(e){t.$set(t.dataForm,"type",e)},expression:"dataForm.type"}},[i("el-radio",{attrs:{label:1,disabled:!!+t.$store.getters.is_root}},[t._v("内部")]),i("el-radio",{attrs:{label:2}},[t._v("行业")]),t.$store.getters.is_official||t.$store.getters.is_root?i("el-radio",{attrs:{label:3}},[t._v("官方")]):t._e()],1)],1),i("el-form-item",{attrs:{label:"内容类型",prop:"content_type"}},[i("el-select",{attrs:{disabled:"",placeholder:"请选择"},model:{value:t.dataForm.content_type,callback:function(e){t.$set(t.dataForm,"content_type",e)},expression:"dataForm.content_type"}},t._l(t.newsClassData,function(t){return i("el-option",{key:t.vv,attrs:{label:t.class_name,value:t.vv}})}),1)],1),i("el-form-item",{attrs:{label:"地区",prop:"address"}},[i("v-distpicker",{attrs:{province:t.dataForm.province,city:t.dataForm.city,area:t.dataForm.district},on:{selected:t.districtSelected}})],1),i("el-form-item",{attrs:{label:"标题",prop:"title"}},[i("el-input",{model:{value:t.dataForm.title,callback:function(e){t.$set(t.dataForm,"title",e)},expression:"dataForm.title"}})],1),4==t.dataForm.content_type?i("el-form-item",{attrs:{label:"展示图",prop:"show_case"}},[i("ImgMutiUpload",{attrs:{imgList:t.dataForm.show_case}})],1):t._e(),i("el-form-item",{attrs:{label:"内容",prop:"content"}},[2==t.dataForm.content_type?i("ImgMutiUpload",{attrs:{imgList:t.dataForm.content}}):t._e(),3==t.dataForm.content_type?i("VideoUpload",{attrs:{video:t.dataForm.content}}):t._e(),1==t.dataForm.content_type?i("docMutiUpload",{attrs:{docmentList:t.dataForm.content}}):t._e(),4==t.dataForm.content_type?i("tinymce",{ref:"tinymce",attrs:{height:550},model:{value:t.dataForm.content,callback:function(e){t.$set(t.dataForm,"content",e)},expression:"dataForm.content"}}):t._e()],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1),i("el-dialog",{attrs:{title:"审核不通过",visible:t.showCheckReason},on:{"update:visible":function(e){t.showCheckReason=e}}},[i("el-form",{ref:"reasonForm",attrs:{rules:t.reasonRule,model:t.reasonForm,"status-icon":"","label-position":"top","label-width":"110px"}},[i("el-form-item",{attrs:{label:"原因",prop:"reason"}},[i("el-input",{model:{value:t.reasonForm.reason,callback:function(e){t.$set(t.reasonForm,"reason",e)},expression:"reasonForm.reason"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.showCheckReason=!1}}},[t._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.submitUnpass}},[t._v("确定")])],1)],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.paginationChange}})],1)},[],!1,null,null,null);e.default=F.exports}}]);