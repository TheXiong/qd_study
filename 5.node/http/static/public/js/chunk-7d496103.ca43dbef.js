(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7d496103"],{"37af":function(e,t,a){},"9f79":function(e,t,a){"use strict";var o=a("37af");a.n(o).a},f833:function(e,t,a){"use strict";a.r(t);a("7f7f"),a("a481");var o=a("f499"),r=a.n(o),n=a("7026"),l=a.n(n),i=a("b775");a("542c");var s={name:"Menu",components:{treeSelect:l.a},data:function(){return{menuList:[],listLoading:!1,options:[],editOptions:[],dialogFormVisible:!1,form:{type:"0",parent:0,name:"",uri:"",uri_hash:"",icon:"",is_menu:"1",note:"",sort:""},formLabelWidth:"120px",rules:{type:[{required:!0,message:"请输入菜单类型",trigger:"blur"}],parent:[{required:!0,message:"请选择父级",trigger:"change"}],uri:[{required:!0,message:"请输入规则",trigger:"blur"}],uri_hash:[{required:!0,message:"请输入hash规则",trigger:"blur"}],name:[{required:!0,message:"请输入标题",trigger:"blur"}],is_menu:[{required:!0,message:"请选择是否菜单",trigger:"blur"}]},tabActiveIndex:"0",expandAll:!1,search:""}},created:function(){this.formCopy=JSON.parse(r()(this.form))},mounted:function(){this.getMenuData()},computed:{filterMenuList:function(){return this.expandAll?this.menuList[this.tabActiveIndex]:this.menuList[this.tabActiveIndex].filter(function(e,t){return"0"!==e.is_menu})}},methods:{getMenuData:function(){var e=this;this.listLoading=!0,Object(i.a)({url:"/auth/access_api/lists",method:"post"}).then(function(t){var a=t.data.data.data;for(var o in a[0]=a[0]?a[0]:[],a[1]=a[1]?a[1]:[],a)for(var r=0;r<a[o].length;r++)a[o][r].name=a[o][r].name.replace(a[o][r].spacer+" ",""),a[o][r].type=a[o][r].type+"";e.menuList=[a[0],a[1]],e.options=[{id:0,label:"根目录",isDefaultExpanded:!0,children:e.generateOption(a[0]).filter(function(e,t){return"1"===e.is_menu})},{id:0,label:"根目录",isDefaultExpanded:!0,children:e.generateOption(a[1]).filter(function(e,t){return"1"===e.is_menu})}],e.listLoading=!1})},addOrUpdateMenu:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a;(t.form.vv?(a=t.form,Object(i.a)({url:"/auth/access_api/edit",method:"post",data:a})):function(e){return Object(i.a)({url:"/auth/access_api/add",method:"post",data:e})}(t.form)).then(function(e){t.$message({showClose:!0,message:e.data.msg,type:"success"}),t.resetForm(),t.getMenuData()})})},handleClose:function(e){this.resetForm(),e()},closeForm:function(e){this.resetForm()},resetForm:function(){this.dialogFormVisible=!1,this.$refs.ruleForm.resetFields(),this.form=JSON.parse(r()(this.formCopy))},editMenu:function(e){var t,a=this;for(var o in(t={vv:e.vv},Object(i.a)({url:"/auth/access_api/find_row",method:"post",data:t})).then(function(e){for(var t=0;t<e.data.data.lists.length;t++)e.data.data.lists[t].name=e.data.data.lists[t].name.replace(e.data.data.lists[t].spacer+" ",""),e.data.data.lists[t].type=e.data.data.lists[t].type+"";a.editOptions=[{id:0,label:"根目录",isDefaultExpanded:!0,children:a.generateOption(e.data.data.lists).filter(function(e,t){return"1"===e.is_menu})}]}),this.form)this.form[o]=e[o];this.form.vv=e.vv,this.dialogFormVisible=!0},deleteMenuById:function(e){var t=this;this.$confirm("你确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a={vv:e},Object(i.a)({url:"/auth/access_api/del",method:"post",data:a})).then(function(e){t.$message({showClose:!0,message:e.data.msg,type:"success"}),t.getMenuData()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},generateOption:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=0;a<e.length;a++)t[a]={},t[a].id=e[a].vv,t[a].is_menu=e[a].is_menu,t[a].label=" "+e[a].spacer+" "+e[a].name;return t}}},u=(a("9f79"),a("2877")),c=Object(u.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("新增菜单")]),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:e.expandAll?"el-icon-minus":"el-icon-plus"},on:{click:function(t){e.expandAll=!e.expandAll}}},[e._v(e._s(e.expandAll?"隐藏功能":"展开功能"))])],1),a("el-dialog",{attrs:{title:e.form.vv?"编辑菜单":"新增菜单",visible:e.dialogFormVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"类型","label-width":e.formLabelWidth,prop:"type"}},[a("el-radio-group",{attrs:{disabled:!!e.form.vv},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-radio",{attrs:{label:"0"}},[e._v("pc端")]),a("el-radio",{attrs:{label:"1"}},[e._v("app端")])],1)],1),a("el-form-item",{attrs:{label:"是否菜单","label-width":e.formLabelWidth,prop:"is_menu"}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.form.is_menu,callback:function(t){e.$set(e.form,"is_menu",t)},expression:"form.is_menu"}})],1),a("el-form-item",{attrs:{label:"父级","label-width":e.formLabelWidth,prop:"parent"}},[a("treeSelect",{attrs:{multiple:!1,options:e.form.vv?e.editOptions:[e.options[e.form.type]]},scopedSlots:e._u([{key:"value-label",fn:function(t){var o=t.node;return a("div",{domProps:{innerHTML:e._s(o.label)}})}},{key:"option-label",fn:function(t){var o=t.node;return a("label",{},[a("span",{domProps:{innerHTML:e._s(o.label)}})])}}]),model:{value:e.form.parent,callback:function(t){e.$set(e.form,"parent",t)},expression:"form.parent"}})],1),a("el-form-item",{attrs:{label:"规则","label-width":e.formLabelWidth,prop:"uri"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.uri,callback:function(t){e.$set(e.form,"uri",t)},expression:"form.uri"}})],1),a("el-form-item",{attrs:{label:"hash规则","label-width":e.formLabelWidth,prop:"uri_hash"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.uri_hash,callback:function(t){e.$set(e.form,"uri_hash",t)},expression:"form.uri_hash"}})],1),a("el-form-item",{attrs:{label:"标题","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"图标","label-width":e.formLabelWidth,prop:"icon"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.icon,callback:function(t){e.$set(e.form,"icon",t)},expression:"form.icon"}})],1),a("el-form-item",{attrs:{label:"权重","label-width":e.formLabelWidth,prop:"sort"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),a("el-form-item",{attrs:{label:"备注","label-width":e.formLabelWidth,prop:"note"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeForm("ruleForm")}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOrUpdateMenu("ruleForm")}}},[e._v("确 定")])],1)],1),a("el-tabs",{attrs:{type:"card"},model:{value:e.tabActiveIndex,callback:function(t){e.tabActiveIndex=t},expression:"tabActiveIndex"}},[a("el-tab-pane",{attrs:{label:"pc端菜单",name:"0"}}),a("el-tab-pane",{attrs:{label:"app端菜单",name:"1"}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:(e.menuList.length?e.filterMenuList:[]).filter(function(t){return!e.search||t.name.toLowerCase().includes(e.search.toLowerCase())}),border:"",fit:""}},[a("el-table-column",{attrs:{align:"center",label:"ID","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:"0"===t.row.is_menu?{color:"#ccc"}:{color:"#000"}},[e._v(e._s(t.row.vv))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"标题","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"menu_name",style:"0"===t.row.is_menu?{color:"#ccc"}:{color:"#000"},domProps:{innerHTML:e._s(" "+t.row.spacer+" "+t.row.name)}})]}}])}),a("el-table-column",{attrs:{align:"center",label:"菜单url","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:"0"===t.row.is_menu?{color:"#ccc"}:{color:"#000"}},[e._v(e._s(t.row.uri_hash))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"接口url","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:"0"===t.row.is_menu?{color:"#ccc"}:{color:"#000"}},[e._v(e._s(t.row.uri))])]}}])}),a("el-table-column",{attrs:{prop:"type","header-align":"center",align:"center",label:"类型","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.is_menu?a("el-tag",{attrs:{size:"small"}},[e._v("功能")]):"1"===t.row.is_menu?a("el-tag",{attrs:{size:"small",type:"success"}},[e._v("菜单")]):e._e()]}}])}),a("el-table-column",{attrs:{align:"center",label:"权重","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.sort))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"300"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"输入标题关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[0!==t.row.vv?a("div",[a("el-button",{attrs:{type:"info",icon:"el-icon-edit"},on:{click:function(a){return e.editMenu(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(a){return e.deleteMenuById(t.row.vv)}}},[e._v("删除")])],1):e._e()]}}])})],1)],1)},[],!1,null,"9a735b84",null);t.default=c.exports}}]);