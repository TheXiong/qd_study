(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-9b23416a"],{"3abe":function(e,t,i){"use strict";i.r(t);var a=i("5176"),r=i.n(a),s=i("e814"),o=i.n(s),l=(i("386d"),i("cebc")),n=i("f499"),c=i.n(n),u=i("f095"),d=i("333d"),m=i("5f87"),f=(i("4360"),i("0ced")),p=i("61f7"),h=i("127f"),b={name:"company",components:{VDistpicker:f.a,Pagination:d.a},data:function(){return{activeTab:"1",type:"渠道",isAddOrUpdate:!1,adminCheckList:[],listLoading:!1,dialogFormVisible:!1,formLabelWidth:"120px",imageUrl:"",form:{name:"",alias:"",is_official:"0",uri:"",leader:"",leader_mobile:"",province:"",city:"",district:"",address:"",business_license_number:"",business_license_image_uri:"",advice:""},rules:{name:[{required:!0,message:"请输入公司名称",trigger:"blur"}],alias:[],uri:[],leader:[{required:!0,message:"请输入负责人姓名",trigger:"blur"}],leader_mobile:[{required:!0,validator:function(e,t,i){return Object(p.b)(t)?i():i(new Error("请输入正确的手机号码")),i()},trigger:"blur"}],province:[],city:[],district:[{required:!0,message:"请选择公司地址",trigger:"blur"}],address:[{required:!0,message:"请输入详细地址",trigger:"blur"}],business_license_number:[{required:!0,message:"请输入营业执照编号",trigger:"blur"}],business_license_image_uri:[{required:!0,message:"请上传营业执照",trigger:"blur"}],advice:[]},token:{"X-Token":Object(m.a)()},total:0,listQuery:{page:1,limit:10},search:{name:"",leader:""},searchRules:{leader:[{required:!1,validator:function(e,t,i){if(t){/^[0-9]+$/.test(t)&&t.length>=3?i():i(new Error("请至少输入3位电话号码"))}else i()},trigger:"blur"}]}}},created:function(){this.formCopy=JSON.parse(c()(this.form)),this.searchCopy=Object(l.a)({},this.search)},mounted:function(){this.fetchWithFilter()},methods:{preview:function(e){var t=document.querySelectorAll('img[myPreview="'+e+'"]');this.openPhotoSwipe(0,t)},handleTab:function(e,t){this.fetchWithFilter()},paginationChange:function(e){this.fetchWithFilter()},query:function(){var e=this;this.$refs.searchForm.validate(function(t){t&&e.fetchWithFilter()})},reset:function(){this.search=Object(l.a)({},this.searchCopy),this.fetchWithFilter()},fetchWithFilter:function(){var e=this;this.listLoading=!0,("1"===this.activeTab||"2"===this.activeTab?Object(u.i)(Object(l.a)({status:"2"===this.activeTab?2:1},this.listQuery,this.search)):Object(u.f)(Object(l.a)({status:o()(this.activeTab)},this.listQuery,this.search))).then(function(t){0==t.data.data.data.length&&e.listQuery.page>1?(e.listQuery.page--,e.fetchWithFilter()):(e.listLoading=!1,e.adminCheckList=t.data.data.data,e.total=t.data.data.total)})},checking:function(e,t){var i=this;Object(u.e)({company:e.vv,status:t,advice:this.form.advice}).then(function(e){i.$message({showClose:!0,message:e.data.msg,type:"success"}),i.fetchWithFilter(),i.resetForm()})},districtSelected:function(e){this.form.province=e.province.code+"",this.form.city=e.city.code+"",this.form.district=e.area.code+""},addOrUpdate:function(){var e=this;this.$refs.ruleForm.validate(function(t){t&&(e.form.vv?Object(u.n)(e.form):Object(u.a)(e.form)).then(function(t){e.$message({showClose:!0,message:t.data.msg,type:"success"}),e.resetForm(),e.fetchWithFilter()})})},edit:function(e){this.isAddOrUpdate=!0,this.openForm(e)},changeContractById:function(e,t){var i=this;this.$confirm("你确定要".concat(1===t?"终止":"恢复","与该公司的合作吗?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(u.d)({vv:e,status:t}).then(function(e){i.$message({showClose:!0,message:e.data.msg,type:"success"}),i.fetchWithFilter()})}).catch(function(){i.$message({type:"info",message:"已取消操作"})})},openForm:function(e){r()(this.form,e),this.dialogFormVisible=!this.dialogFormVisible},handleClose:function(e){this.resetForm(),e()},closeForm:function(e){this.resetForm()},resetForm:function(){this.dialogFormVisible=!1,this.isAddOrUpdate=!1,this.$refs.ruleForm.resetFields(),this.form=JSON.parse(c()(this.formCopy))},companyTypeChange:function(e){this.$refs.ruleForm.validateField("type")},fnUploadRequest:function(e){h.a.ossUploadFile(e)},handleAvatarSuccess:function(e,t){this.form.uri=e.requestUrls[0],this.$message({showClose:!0,message:"上传成功",type:-1===e.code?"error":"success"})},handleLicenseSuccess:function(e,t){this.form.business_license_image_uri=e.requestUrls[0],this.$message({showClose:!0,message:"上传成功",type:-1===e.code?"error":"success"})},beforeAvatarUpload:function(e){var t=0===e.type.indexOf("image"),i=e.size/1024/1024<20;return t||this.$message.error("上传文件只能是图片!"),i||this.$message.error("上传文件大小不能超过 20MB!"),t&&i},add:function(){this.dialogFormVisible=!0,this.isAddOrUpdate=!0}}},v=(i("76d7"),i("2877")),g=Object(v.a)(b,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.add}},[e._v("新建公司")])],1),i("el-tabs",{on:{"tab-click":e.handleTab},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[i("el-tab-pane",{attrs:{label:"已通过",name:"1"}}),i("el-tab-pane",{attrs:{label:"待审核",name:"0"}}),i("el-tab-pane",{attrs:{label:"已终止合作",name:"2"}})],1),i("div",{staticClass:"filter-container"},[i("el-form",{ref:"searchForm",attrs:{inline:!0,rules:e.searchRules,model:e.search}},[i("el-form-item",{attrs:{label:"公司名称"}},[i("el-input",{model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),i("el-form-item",{attrs:{label:"负责人姓名或电话",prop:"leader"}},[i("el-input",{attrs:{placeholder:"若输入电话号码请不少于3位"},model:{value:e.search.leader,callback:function(t){e.$set(e.search,"leader",t)},expression:"search.leader"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")]),i("el-button",{attrs:{type:"primary"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.adminCheckList,"tooltip-effect":"dark",border:"",fit:""}},[i("el-table-column",{attrs:{align:"center",label:"序号","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s((e.listQuery.page-1)*e.listQuery.limit+t.$index+1))]}}])}),i("el-table-column",{attrs:{prop:"name",align:"center",label:"名称",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),i("el-table-column",{attrs:{prop:"alias",align:"center",label:"别名",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.alias))]}}])}),i("el-table-column",{attrs:{prop:"leader",align:"center",label:"负责人"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.leader))]}}])}),i("el-table-column",{attrs:{prop:"leader_mobile",align:"center",label:"负责人电话"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.leader_mobile))]}}])}),i("el-table-column",{attrs:{prop:"address",align:"center",label:"公司地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.detail_address))]}}])}),i("el-table-column",{attrs:{label:"操作",align:"center",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"===e.activeTab?i("el-button",{attrs:{type:"info",icon:"el-icon-edit"},on:{click:function(i){return e.edit(t.row)}}},[e._v("编辑")]):e._e(),"0"===e.activeTab?i("el-button",{attrs:{type:"info",icon:"el-icon-edit"},on:{click:function(i){return e.openForm(t.row)}}},[e._v("审核")]):e._e(),"1"===e.activeTab?i("el-button",{attrs:{type:"danger",icon:"el-icon-edit"},on:{click:function(i){return e.changeContractById(t.row.vv,1)}}},[e._v("终止合作")]):e._e(),"2"===e.activeTab?i("el-button",{attrs:{type:"info",icon:"el-icon-edit"},on:{click:function(i){return e.openForm(t.row)}}},[e._v("查看资料")]):e._e(),"2"===e.activeTab?i("el-button",{attrs:{type:"info",icon:"el-icon-edit"},on:{click:function(i){return e.changeContractById(t.row.vv,2)}}},[e._v("恢复合作")]):e._e()]}}])})],1),i("el-dialog",{attrs:{title:e.isAddOrUpdate?e.form.vv?"公司编辑":"新建公司":"公司审核",visible:e.dialogFormVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules}},[i("el-form-item",{attrs:{label:"公司名称","label-width":e.formLabelWidth,prop:"name"}},[i("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"64","show-word-limit":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"公司别名","label-width":e.formLabelWidth,prop:"alias"}},[i("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"64","show-word-limit":""},model:{value:e.form.alias,callback:function(t){e.$set(e.form,"alias",t)},expression:"form.alias"}})],1),i("el-form-item",{attrs:{label:"是否官方","label-width":e.formLabelWidth,prop:"alias"}},[i("el-switch",{attrs:{"active-color":"#13ce66","active-value":1,"inactive-value":0},model:{value:e.form.is_official,callback:function(t){e.$set(e.form,"is_official",t)},expression:"form.is_official"}})],1),i("el-form-item",{attrs:{label:"公司头像","label-width":e.formLabelWidth,prop:"uri"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:"",headers:e.token,"show-file-list":!1,accept:"image/*","http-request":e.fnUploadRequest,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.uri?i("img",{staticClass:"avatar",attrs:{src:e.form.uri,myPreview:"uri"}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e.form.uri?i("el-button",{staticClass:"preview",attrs:{size:"mini"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.preview("uri")}}},[e._v("点击预览")]):e._e()],1)],1),i("el-form-item",{attrs:{label:"负责人","label-width":e.formLabelWidth,prop:"leader"}},[i("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"32","show-word-limit":""},model:{value:e.form.leader,callback:function(t){e.$set(e.form,"leader",t)},expression:"form.leader"}})],1),i("el-form-item",{attrs:{label:"电话","label-width":e.formLabelWidth,prop:"leader_mobile"}},[i("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"11","show-word-limit":""},model:{value:e.form.leader_mobile,callback:function(t){e.$set(e.form,"leader_mobile",t)},expression:"form.leader_mobile"}})],1),i("el-form-item",{attrs:{label:"地址","label-width":e.formLabelWidth,prop:"district"}},[i("v-distpicker",{attrs:{province:e.form.province,city:e.form.city,area:e.form.district},on:{selected:e.districtSelected}})],1),i("el-form-item",{attrs:{label:"详细地址","label-width":e.formLabelWidth,prop:"address"}},[i("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"200","show-word-limit":""},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("el-form-item",{attrs:{label:"营业执照编号","label-width":e.formLabelWidth,prop:"business_license_number"}},[i("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"64","show-word-limit":""},model:{value:e.form.business_license_number,callback:function(t){e.$set(e.form,"business_license_number",t)},expression:"form.business_license_number"}})],1),i("el-form-item",{attrs:{label:"营业执照","label-width":e.formLabelWidth,prop:"business_license_image_uri"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:"",headers:e.token,"show-file-list":!1,accept:"image/*","http-request":e.fnUploadRequest,"on-success":e.handleLicenseSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.business_license_image_uri?i("img",{staticClass:"avatar",attrs:{src:e.form.business_license_image_uri,myPreview:"business_license_image_uri"}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e.form.business_license_image_uri?i("el-button",{staticClass:"preview",attrs:{size:"mini"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.preview("business_license_image_uri")}}},[e._v("点击预览")]):e._e()],1)],1),"0"===e.activeTab||"-1"===e.activeTab?i("el-form-item",{attrs:{label:"审核意见","label-width":e.formLabelWidth,prop:"advice"}},[i("el-input",{attrs:{type:"textarea",autocomplete:"off",maxlength:"200","show-word-limit":""},model:{value:e.form.advice,callback:function(t){e.$set(e.form,"advice",t)},expression:"form.advice"}})],1):e._e()],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isAddOrUpdate?i("el-button",{attrs:{type:"danger",icon:"el-icon-edit"},on:{click:e.addOrUpdate}},[e._v("确定")]):e._e(),"0"===e.activeTab||"-1"===e.activeTab?i("el-button",{attrs:{type:"success"},on:{click:function(t){return e.checking(e.form,1)}}},[i("svg-icon",{attrs:{"icon-class":"pass"}}),e._v("通过\n      ")],1):e._e(),"0"===e.activeTab?i("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.checking(e.form,-1)}}},[i("svg-icon",{attrs:{"icon-class":"reject"}}),e._v("不通过\n      ")],1):e._e(),i("el-button",{attrs:{type:"info"},on:{click:e.closeForm}},[i("svg-icon",{attrs:{"icon-class":"cancel"}}),e._v("取消\n      ")],1)],1)],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.paginationChange}})],1)},[],!1,null,"0ec111c8",null);t.default=g.exports},"76d7":function(e,t,i){"use strict";var a=i("85dd");i.n(a).a},"85dd":function(e,t,i){}}]);